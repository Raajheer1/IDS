<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Denver IDS</title>
    <!-- <link rel="stylesheet" href="https://bootswatch.com/4/lux/bootstrap.min.css"> -->
    <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.min.css">
</head>

<body>

    <body style="background-color: #242322; padding: 15px 15px 15px 15px;">
        <div class="container-fluid" id="loginscreen" style="margin-top: 15px;">
            <div class="row justify-content-center" style="text-align: center;">
                <img src="img/logo.png">
            </div>
            <div class="row justify-content-center" style="text-align: center;">
                <form id="LoginForm">
                    <div class="form-group">
                        <label for="exampleInputEmail1" style="color: azure;">VATSIM CID</label>
                        <input type="text" class="form-control" id="idscid" aria-describedby="cidhelp">
                    </div>
                    <div class="form-group">
                        <label for="idspass" style="color: azure;">ZDV-IDS Password</label>
                        <input type="password" class="form-control" id="idspass" aria-describedby="passhelp">
                        <small id="passhelp" class="form-text text-muted">Not your VATSIM Password!</small>
                    </div>
                    <button type="submit" class="btn btn-success">Login</button>
                    <br>
                </form>
            </div>
            <div class="row justify-content-center" style="text-align: center;">
                <span id="loginwrong" style="font-size: 20px; color: #F97E41;"></span>
            </div>
        </div>
    </body>

    <script>
        const customTitlebar = require('custom-electron-titlebar');
        let IDSTitleBar = new customTitlebar.Titlebar({
            backgroundColor: customTitlebar.Color.fromHex("#1F1F1F"),
            shadow: true,
            icon: "./img/icon.png"
        });

        IDSTitleBar.updateTitle('Login - ZDVARTCC');
    </script>
    <script>
        const electron = require('electron');
        const { ipcRenderer } = electron;
        var request = new XMLHttpRequest();

        const IDSLogin = document.getElementById("LoginForm");
        IDSLogin.addEventListener('submit', (e) => {
            e.preventDefault();
            const cid = document.querySelector("#idscid").value;
            const pass = document.querySelector("#idspass").value;
            // RAAJ PATEL
            // const cid = 1293257;
            // const pass = "GtfwPrOMNQ";
            // JAMES ROBERTS
            // const cid = 1047917;
            // const pass = "V6mOmLUs6m";
            // ANDREW ALLEN
            // const cid = 1410636
            // const pass = "nMSEbbnrKM"
            var autharray;
            request.open("GET", "https://denartcc.org/idsauth?cid=" + cid + "&password=" + pass);
            request.send();
            request.onload = function () {
                if (request.status != 200) {
                    console.log("ZDV Authentication Server is Down.");
                } else {
                    autharray = JSON.parse(request.response);
                    if (autharray.length == 0) {
                        document.getElementById("loginwrong").innerHTML = `Wrong username or password, please make sure you are NOT entering your VATSIM Password.<br> You can get your password <a onclick="electron.shell.openExternal('https://denartcc.org/accounts');" href="" style="color: white;">here</a>.`;
                    }else{
                        ipcRenderer.send("USER:add", autharray);
                    }
                }
            }
        });
    </script>

</html>